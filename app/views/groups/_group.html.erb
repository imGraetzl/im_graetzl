<div class="cardBox -group" data-behavior="masonry-card">

  <div class="cardBoxHeader">
    <div class="coverImgWrapper">
      <%= link_to cover_photo_for(group), group %>
    </div>
    <div class="categoryicon">
      <%= icon_tag "speech-bubble" %>
    </div>
    <% if group.group_categories.first %>
      <div class="sideflag -category -R">
        <%= safe_join(group.group_categories.map { |category| link_to(category.title, groups_wien_path(:category => category.id), :rel => 'nofollow') }, ', ') %>
      </div>
    <% end %>
  </div>

  <div class="cardBoxContent -group">

    <%= link_to group.title, group, class: 'title' %>

    <p class="infos">
      <%= group.users.size %> <%= group.users.size > 1 ? "Mitglieder" : "Mitglied" %>  &middot;
      <%= group.private? ? "Geschlossene" : "Offene" %> Gruppe
    </p>

    <div class="users">

      <% group.admins.each do |user| next if user == current_user %>
          <%= attachment_image_tag user, :avatar, :fill, 100, 100, fallback: 'avatar/user/100x100.png', class: 'img-round' %>
      <% end %>

      <% if group.users.include?(current_user) %>
        <%= attachment_image_tag current_user, :avatar, :fill, 200, 200, fallback: 'avatar/user/200x200.png', class: 'img-round' %>
      <% end %>

      <% group.members.first(10 - group.admins_and_current_user_count(current_user)).each do |user| next if user == current_user %>
        <%= attachment_image_tag user, :avatar, :fill, 200, 200, fallback: 'avatar/user/200x200.png', class: 'img-round' %>
      <% end %>
      <% if group.users.size > 10 %>
        <span> + <%= group.users.size - 10 %> weitere </span>
      <% end %>

    </div>

    <div class="slogan">
      <%= truncate group.description.bbcode_to_html.html_safe, length: 100, :escape => false %>
    </div>

    <%= link_to "Zur Gruppe", group, class: 'btn-userIcons -mint' %>
  </div>
</div>
